@model CarpoolingCR.Models.ApplicationUser

<div class="row">
    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
        <div class="pull-right selectable-div" style="width:110px;cursor:pointer; border-radius:10px" onclick="PopUpUserInfo()">
            @{
                <div class="pull-right" id="profile-container-small" data-toggle="tooltip" style="margin-right:30px;" title="Conductor">
                    <img id="profileImage" class="center-block" src="@Url.Content(Model.Picture)" />
                </div>
                var stars = Model.Stars;

                <small class="center-block">
                    @Html.Partial("~/Views/Account/Partials/p_UserStars.cshtml", stars)
                </small>

                <small class="center-block" style="text-align:center">
                    <span class="fas fa-chevron-down center-block" style="text-align:center"></span>
                </small>
                
            }
        </div>
    </div>
</div>

<div class="modal fade" id="rateUserInfoModal" tabindex="-1" role="dialog" aria-labelledby="rateUserInfoModalModalLabel" aria-hidden="true">
    <div class="vertical-alignment-helper">
        <div class="modal-dialog vertical-align-center">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span><span class="sr-only">Close</span>
                    </button>
                    <h4 class="modal-title" id="dayTripModalLabel">Información de Usuarios</h4>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                            <div class="center-block" style="width:110px;border-radius:10px;text-align:center">
                                @{
                                    <div id="profile-container-small" data-toggle="tooltip" style="margin-right:0px;width:100px; height:100px" title="Conductor">
                                        <img id="profileImage" src="@Url.Content(Model.Picture)" style="margin-right:0px;width:100px; height:100px" />
                                    </div>

                                    <small style="text-align:center">
                                        @Html.Partial("~/Views/Account/Partials/p_UserStars.cshtml", Model.Stars)
                                    </small>
                                }
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" style="text-align:center">
                            <h4>@Model.FullName</h4>
                        </div>
                    </div>
                    <hr style="padding:0px; margin:0px" />
                    <h6 class="text-default">Verificación de datos personales:</h6>
                    <div class="row">
                        <div class="col-lg-3 col-md-3 col-sm-3 col-xs-4">
                            @{
                                if (Model.EmailConfirmed)
                                {
                                    <small class="text-success"><span class="fas fa-check"></span>&nbsp;Email</small>
                                }
                                else
                                {
                                    <small class="text-danger"><span class="fas fa-times"></span>&nbsp;Email</small>
                                }
                            }
                        </div>
                        <div class="col-lg-3 col-md-3 col-sm-3 col-xs-4">
                            @{
                                if (Model.IsPhoneVerified)
                                {
                                    <small class="text-success"><span class="fas fa-check"></span>&nbsp;Celular</small>
                                }
                                else
                                {
                                    <small class="text-danger"><span class="fas fa-times"></span>&nbsp;Celular</small>
                                }
                            }
                        </div>
                        <div class="col-lg-3 col-md-3 col-sm-3 col-xs-4">
                            @{
                                if (Model.IsUserIdentificationVerified)
                                {
                                    <small class="text-success"><span class="fas fa-check"></span>&nbsp;Cédula</small>
                                }
                                else
                                {
                                    <small class="text-danger"><span class="fas fa-times"></span>&nbsp;Cédula</small>
                                }
                            }
                        </div>
                    </div>
                    <hr style="padding:0px; margin:0px" />
                    <div class="row">
                        <div class="col-lg-3 col-md-3 col-sm-3 col-xs-6">
                            @{
                                if (Model.BirthDay != null)
                                {
                                    var today = DateTime.Today;
                                    var age = today.Year - ((DateTime)Model.BirthDay).Year;

                                    if (((DateTime)Model.BirthDay).Date > today.AddYears(-age))
                                    {
                                        age--;
                                    }

                                    <small><small><b>Edad: </b> <br /> @age</small></small>
                                }
                            }
                        </div>
                        <div class="col-lg-3 col-md-3 col-sm-3 col-xs-6">
                            <small><small><b>Miembro Desde: </b><br /> @Model.MemberSince.ToString("MMMM, yyyy")</small></small>
                        </div>
                        <div class="col-lg-3 col-md-3 col-sm-3 col-xs-6">
                            <small><small><b>Reservaciones: </b><br /> @Model.ReservationsAmount</small></small>
                        </div>
                        @{
                            if (Model.UserType != CarpoolingCR.Utils.Enums.UserType.Pasajero)
                            {
                                <div class="col-lg-3 col-md-3 col-sm-3 col-xs-6">
                                    <small><small><b>Viajes: </b><br /> @Model.TripsAmount</small></small>
                                </div>
                            }
                        }
                    </div>
                    <hr style="padding:0px; margin:0px" />
                    <h6 class="text-default">Comentarios:</h6>
                    @{
                        if (Model.UserRatings.Count() == 0)
                        {
                            <div class="row">
                                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" style="text-align:center">
                                    <small>¡No hay calificaciones registradas!</small>
                                </div>
                            </div>
                        }
                        else
                        {
                            foreach (var rating in Model.UserRatings)
                            {
                                rating.LoadUserInstances = true;

                                <hr style="padding:0px; margin:0px" />

                                <div class="row">
                                    <div class="col-lg-2 col-md-2 col-sm-2 col-xs-3">
                                        <div id="profile-container-small" data-toggle="tooltip" style="margin-right:0px" title="Conductor">
                                            <img id="profileImage" src="@Url.Content(rating.FromUser.Picture)" style="margin-right:0px;" />
                                        </div>
                                        <small>&nbsp;&nbsp;@rating.FromUser.Name</small>
                                    </div>
                                    <div class="col-lg-10 col-md-10 col-sm-10 col-xs-9">
                                        <small>
                                            <small>
                                                @Html.Partial("~/Views/Account/Partials/p_UserStars.cshtml", rating.Stars)
                                            </small>
                                        </small>
                                        <small>@rating.Comments</small>
                                    </div>
                                </div>
                            }
                        }
                    }
                </div>
                <div id="btnsContainer" class="modal-footer">
                    <input type="button" class="btn btn-default" data-dismiss="modal" value="Cerrar" />
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    function PopUpUserInfo() {
        $('#rateUserInfoModal').modal();
    }
</script>

