@model IEnumerable<CarpoolingCR.Models.Trip>
@{
    ViewBag.Title = "LoadDriverTripHistorial";
}

<style>
    .checked {
        color: orange;
    }
</style>
<h2>Hstorial de viajes</h2>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<div class="row form-group">
    @{ if (Model.ToList().Count == 0)
        { <div class="row form-group" style="text-align:center">
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    ¡No se encontraron viajes!
                </div>
            </div>
        }
        else
        {
            foreach (var trip in Model)
            {
                <hr />
                var from = trip.FromTown.FullName;
                var to = trip.ToTown.FullName;

                <div class="row form-group bg-info" style="border-radius:10px">
                    <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                        <label class="control-label fromto">@from -> @to</label><br />
                        <small class="date">@trip.DateTime.ToString("dd/MM/yyyy hh:mm tt")</small>
                    </div>
                    <div class="col-lg-2 col-md-2 col-sm-12 col-xs-12">
                        @{
                            if (trip.Qualifications.Count > 0)
                            {
                                var totalStars = 0;

                                foreach (var qualification in trip.Qualifications)
                                {
                                    totalStars += qualification.Starts;
                                }

                                var average = totalStars / trip.Qualifications.Count;

                                switch (average)
                                {
                                    case 1:
                                        <a href="#" data-toggle="tooltip" title="Muy Malo"><span id="star1" class="fa fa-star checked" data-toggle="Muy Malo"></span></a>
                                        <a href="#" data-toggle="tooltip" title="Malo"><span id="star2" class="fa fa-star" data-toggle="Malo"></span></a>
                                        <a href="#" data-toggle="tooltip" title="Bueno"><span id="star3" class="fa fa-star" data-toggle="Bueno"></span></a>
                                        <a href="#" data-toggle="tooltip" title="Muy Bueno"><span id="star4" class="fa fa-star" data-toggle="Muy Bueno"></span></a>
                                        <a href="#" data-toggle="tooltip" title="Excelente"><span id="star5" class="fa fa-star" data-toggle="Excelente"></span></a>
                                        break;
                                    case 2:
                                        <a href="#" data-toggle="tooltip" title="Muy Malo"><span id="star1" class="fa fa-star checked" data-toggle="Muy Malo"></span></a>
                                        <a href="#" data-toggle="tooltip" title="Malo"><span id="star2" class="fa fa-star checked" data-toggle="Malo"></span></a>
                                        <a href="#" data-toggle="tooltip" title="Bueno"><span id="star3" class="fa fa-star" data-toggle="Bueno"></span></a>
                                        <a href="#" data-toggle="tooltip" title="Muy Bueno"><span id="star4" class="fa fa-star" data-toggle="Muy Bueno"></span></a>
                                        <a href="#" data-toggle="tooltip" title="Excelente"><span id="star5" class="fa fa-star" data-toggle="Excelente"></span></a>
                                        break;
                                    case 3:
                                        <a href="#" data-toggle="tooltip" title="Muy Malo"><span id="star1" class="fa fa-star checked" data-toggle="Muy Malo"></span></a>
                                        <a href="#" data-toggle="tooltip" title="Malo"><span id="star2" class="fa fa-star checked" data-toggle="Malo"></span></a>
                                        <a href="#" data-toggle="tooltip" title="Bueno"><span id="star3" class="fa fa-star checked" data-toggle="Bueno"></span></a>
                                        <a href="#" data-toggle="tooltip" title="Muy Bueno"><span id="star4" class="fa fa-star" data-toggle="Muy Bueno"></span></a>
                                        <a href="#" data-toggle="tooltip" title="Excelente"><span id="star5" class="fa fa-star" data-toggle="Excelente"></span></a>
                                        break;
                                    case 4:
                                        <a href="#" data-toggle="tooltip" title="Muy Malo"><span id="star1" class="fa fa-star checked" data-toggle="Muy Malo"></span></a>
                                        <a href="#" data-toggle="tooltip" title="Malo"><span id="star2" class="fa fa-star checked" data-toggle="Malo"></span></a>
                                        <a href="#" data-toggle="tooltip" title="Bueno"><span id="star3" class="fa fa-star checked" data-toggle="Bueno"></span></a>
                                        <a href="#" data-toggle="tooltip" title="Muy Bueno"><span id="star4" class="fa fa-star checked" data-toggle="Muy Bueno"></span></a>
                                        <a href="#" data-toggle="tooltip" title="Excelente"><span id="star5" class="fa fa-star" data-toggle="Excelente"></span></a>
                                        break;
                                    case 5:
                                        <a href="#" data-toggle="tooltip" title="Muy Malo"><span id="star1" class="fa fa-star checked" data-toggle="Muy Malo"></span></a>
                                        <a href="#" data-toggle="tooltip" title="Malo"><span id="star2" class="fa fa-star checked" data-toggle="Malo"></span></a>
                                        <a href="#" data-toggle="tooltip" title="Bueno"><span id="star3" class="fa fa-star checked" data-toggle="Bueno"></span></a>
                                        <a href="#" data-toggle="tooltip" title="Muy Bueno"><span id="star4" class="fa fa-star checked" data-toggle="Muy Bueno"></span></a>
                                        <a href="#" data-toggle="tooltip" title="Excelente"><span id="star5" class="fa fa-star checked" data-toggle="Excelente"></span></a>
                                        break;
                                }
                            }
                        }
                    </div>
                    <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12" style="text-align:justify">
                        <b>Comentarios</b>
                    </div>
                </div>

                foreach (var reservation in trip.Reservations)
                {
                    <div class="row form-group">
                        <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                            <small class="pull-right"><b>- Pasajero: </b> @reservation.ApplicationUser.FullName</small><br />
                        </div>
                        <div class="col-lg-2 col-md-2 col-sm-12 col-xs-12">
                            @{
                                var qualification = trip.Qualifications.Where(x => x.ReservationId == reservation.ReservationId).SingleOrDefault();

                                if (qualification != null)
                                {
                                    switch (qualification.Starts)
                                    {
                                        case 1:
                                            <a href="#" data-toggle="tooltip" title="Muy Malo"><span id="star1" class="fa fa-star checked" data-toggle="Muy Malo"></span></a>
                                            <a href="#" data-toggle="tooltip" title="Malo"><span id="star2" class="fa fa-star" data-toggle="Malo"></span></a>
                                            <a href="#" data-toggle="tooltip" title="Bueno"><span id="star3" class="fa fa-star" data-toggle="Bueno"></span></a>
                                            <a href="#" data-toggle="tooltip" title="Muy Bueno"><span id="star4" class="fa fa-star" data-toggle="Muy Bueno"></span></a>
                                            <a href="#" data-toggle="tooltip" title="Excelente"><span id="star5" class="fa fa-star" data-toggle="Excelente"></span></a>
                                            break;
                                        case 2:
                                            <a href="#" data-toggle="tooltip" title="Muy Malo"><span id="star1" class="fa fa-star checked" data-toggle="Muy Malo"></span></a>
                                            <a href="#" data-toggle="tooltip" title="Malo"><span id="star2" class="fa fa-star checked" data-toggle="Malo"></span></a>
                                            <a href="#" data-toggle="tooltip" title="Bueno"><span id="star3" class="fa fa-star" data-toggle="Bueno"></span></a>
                                            <a href="#" data-toggle="tooltip" title="Muy Bueno"><span id="star4" class="fa fa-star" data-toggle="Muy Bueno"></span></a>
                                            <a href="#" data-toggle="tooltip" title="Excelente"><span id="star5" class="fa fa-star" data-toggle="Excelente"></span></a>
                                            break;
                                        case 3:
                                            <a href="#" data-toggle="tooltip" title="Muy Malo"><span id="star1" class="fa fa-star checked" data-toggle="Muy Malo"></span></a>
                                            <a href="#" data-toggle="tooltip" title="Malo"><span id="star2" class="fa fa-star checked" data-toggle="Malo"></span></a>
                                            <a href="#" data-toggle="tooltip" title="Bueno"><span id="star3" class="fa fa-star checked" data-toggle="Bueno"></span></a>
                                            <a href="#" data-toggle="tooltip" title="Muy Bueno"><span id="star4" class="fa fa-star" data-toggle="Muy Bueno"></span></a>
                                            <a href="#" data-toggle="tooltip" title="Excelente"><span id="star5" class="fa fa-star" data-toggle="Excelente"></span></a>
                                            break;
                                        case 4:
                                            <a href="#" data-toggle="tooltip" title="Muy Malo"><span id="star1" class="fa fa-star checked" data-toggle="Muy Malo"></span></a>
                                            <a href="#" data-toggle="tooltip" title="Malo"><span id="star2" class="fa fa-star checked" data-toggle="Malo"></span></a>
                                            <a href="#" data-toggle="tooltip" title="Bueno"><span id="star3" class="fa fa-star checked" data-toggle="Bueno"></span></a>
                                            <a href="#" data-toggle="tooltip" title="Muy Bueno"><span id="star4" class="fa fa-star checked" data-toggle="Muy Bueno"></span></a>
                                            <a href="#" data-toggle="tooltip" title="Excelente"><span id="star5" class="fa fa-star" data-toggle="Excelente"></span></a>
                                            break;
                                        case 5:
                                            <a href="#" data-toggle="tooltip" title="Muy Malo"><span id="star1" class="fa fa-star checked" data-toggle="Muy Malo"></span></a>
                                            <a href="#" data-toggle="tooltip" title="Malo"><span id="star2" class="fa fa-star checked" data-toggle="Malo"></span></a>
                                            <a href="#" data-toggle="tooltip" title="Bueno"><span id="star3" class="fa fa-star checked" data-toggle="Bueno"></span></a>
                                            <a href="#" data-toggle="tooltip" title="Muy Bueno"><span id="star4" class="fa fa-star checked" data-toggle="Muy Bueno"></span></a>
                                            <a href="#" data-toggle="tooltip" title="Excelente"><span id="star5" class="fa fa-star checked" data-toggle="Excelente"></span></a>
                                            break;
                                    }
                                }
                            }

                        </div>
                        <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12" style="text-align:justify">
                            @{
                                if (qualification == null)
                                {
                                    <small class="text-warning">¡@reservation.ApplicationUser.FullName no te ha calificado!</small>
                                }
                                else
                                {
                                    <small>@qualification.Comments</small>
                                }

                                if (!reservation.IsPassengerQualified)
                                {
                                    <input type="button" class="btn btn-info pull-right" value="Calificar" onclick="PopUpQualifyModal(@reservation.ReservationId, null, '@reservation.ApplicationUser.FullName')" />
                                }
                            }
                        </div>
                    </div>
                }
            }
        }
    }
</div>

<script>
    $(document).ready(function () {
        $('[data-toggle="tooltip"]').tooltip();
    });
</script>